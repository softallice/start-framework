(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[69],{5117:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{staticClass:"flex flex-center content-start"},[t("q-table",{staticClass:"q-pa-md q-ma-md",attrs:{dense:e.$q.screen.lt.md,title:"Users",data:e.users,columns:e.columns,"row-key":"name",pagination:e.paginationOpts},on:{"update:pagination":function(a){e.paginationOpts=a},request:e.getTableUsers},scopedSlots:e._u([{key:"body-cell-name",fn:function(a){return[t("q-td",{attrs:{props:a}},[e._v("\n        "+e._s(a.row.firstname)+" "+e._s(a.row.lastname)+"\n      ")])]}},{key:"body-cell-role",fn:function(a){return[t("q-td",{staticClass:"text-capitalize"},[e._v("\n        "+e._s(a.row.permissions?a.row.permissions[0]:"")+"\n      ")])]}},{key:"body-cell-action",fn:function(a){return[t("q-td",{attrs:{props:a}},[t("q-btn",{staticClass:"q-pa-xs q-mx-xs",attrs:{size:"sm",dense:"",color:"primary",title:"Edit User"},on:{click:function(t){return e.updateUser(a.row)}}},[e._v("Edit User\n        ")]),t("q-btn",{staticClass:"q-pa-xs q-mx-xs",attrs:{size:"sm",dense:"",color:"purple",title:"Reset Password"},on:{click:function(t){return e.resetPassword(a.row.email)}}},[e._v("Reset Password")]),t("q-btn",{staticClass:"q-pa-xs q-mx-xs",attrs:{size:"sm",dense:"",color:"orange",title:"Impersonate User"},on:{click:function(t){return e.impersonate(a.row._id)}}},[e._v("Impersonate")]),t("q-btn",{staticClass:"q-pa-xs q-mx-xs",attrs:{size:"sm",dense:"",color:"red",title:"Deactivate User"},on:{click:function(t){return e.deactiveateUser(a.row)}}},[e._v("Deactivate User")])],1)]}}])}),t("q-dialog",{attrs:{persistent:""},model:{value:e.showEditUser,callback:function(a){e.showEditUser=a},expression:"showEditUser"}},[t("q-card",[t("q-card-section",{staticClass:"row items-center"},[t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{staticClass:"q-ma-sm",attrs:{outlined:"",label:"First Name","label-color":"accent",hint:"Given Name","lazy-rules":"",dense:"",error:e.$v.profileData.firstname.$invalid&&e.$v.profileData.firstname.$dirty},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{color:"accent",name:"fas fa-user",size:"xs"}})]},proxy:!0},{key:"error",fn:function(){return[e.$v.profileData.firstname.required?e._e():t("div",[e._v("\n                This field is required.\n              ")]),e.$v.profileData.firstname.minLength?e._e():t("div",[e._v("\n                Must contain at least 2 characters.\n              ")]),e.$v.profileData.firstname.maxLength?e._e():t("div",[e._v("\n                Cannot be over 30 characters.\n              ")])]},proxy:!0}]),model:{value:e.$v.profileData.firstname.$model,callback:function(a){e.$set(e.$v.profileData.firstname,"$model",a)},expression:"$v.profileData.firstname.$model"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{staticClass:"q-ma-sm",attrs:{outlined:"",label:"Family Name","label-color":"accent",hint:"Surname","lazy-rules":"",dense:"",error:e.$v.profileData.lastname.$invalid&&e.$v.profileData.lastname.$dirty,"error-message":"Must be at least 2 characters"},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{color:"accent",name:"fas fa-user",size:"xs"}})]},proxy:!0},{key:"error",fn:function(){return[e.$v.profileData.lastname.required?e._e():t("div",[e._v("\n                This field is required.\n              ")]),e.$v.profileData.lastname.minLength?e._e():t("div",[e._v("\n                Must contain at least 2 characters.\n              ")]),e.$v.profileData.lastname.maxLength?e._e():t("div",[e._v("\n                Cannot be over 30 characters.\n              ")])]},proxy:!0}]),model:{value:e.$v.profileData.lastname.$model,callback:function(a){e.$set(e.$v.profileData.lastname,"$model",a)},expression:"$v.profileData.lastname.$model"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{staticClass:"q-ma-sm",attrs:{outlined:"",label:"Company","label-color":"accent","lazy-rules":"",dense:"",error:e.$v.profileData.company.$invalid&&e.$v.profileData.company.$dirty},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{color:"accent",name:"fas fa-building",size:"xs"}})]},proxy:!0},{key:"error",fn:function(){return[e.$v.profileData.company.minLength?e._e():t("div",[e._v("\n                Must contain at least 2 characters.\n              ")]),e.$v.profileData.company.maxLength?e._e():t("div",[e._v("\n                Cannot be over 30 characters.\n              ")])]},proxy:!0}]),model:{value:e.$v.profileData.company.$model,callback:function(a){e.$set(e.$v.profileData.company,"$model",a)},expression:"$v.profileData.company.$model"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{staticClass:"q-ma-sm",attrs:{outlined:"",label:"City","label-color":"accent","lazy-rules":"",dense:"",error:e.$v.profileData.city.$invalid&&e.$v.profileData.city.$dirty},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{color:"accent",name:"fas fa-city",size:"xs"}})]},proxy:!0},{key:"error",fn:function(){return[e.$v.profileData.city.minLength?e._e():t("div",[e._v("\n                Must contain at least 2 characters.\n              ")]),e.$v.profileData.city.maxLength?e._e():t("div",[e._v("\n                Cannot be over 30 characters.\n              ")])]},proxy:!0}]),model:{value:e.$v.profileData.city.$model,callback:function(a){e.$set(e.$v.profileData.city,"$model",a)},expression:"$v.profileData.city.$model"}})],1)]),t("q-card-section",[t("div",{staticClass:"col-12"},[t("q-select",{staticClass:"q-ma-sm text-capitalize",attrs:{dense:"",outlined:"",options:e.roles,label:"User Role","popup-content-class":"text-capitalize","options-selected-class":"primary",error:e.$v.profileData.role.$invalid&&e.$v.profileData.role.$dirty},scopedSlots:e._u([{key:"error",fn:function(){return[e.$v.profileData.role.required?e._e():t("div",[e._v("\n                Must have a role.\n              ")])]},proxy:!0}]),model:{value:e.$v.profileData.role.$model,callback:function(a){e.$set(e.$v.profileData.role,"$model",a)},expression:"$v.profileData.role.$model"}})],1)]),t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancel",flat:""}}),e.selectedUser.isVerified?e._e():t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Resend Email Verification",color:"secondary"},on:{click:function(a){return e.resendEmailVerification(e.selectedUser.email)}}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:e.disableUpdateProfile,label:"Update User",type:"submit",color:"positive"},on:{click:e.saveUpdatedUser},scopedSlots:e._u([{key:"loading",fn:function(){return[t("q-spinner-facebook")]},proxy:!0}])})],1)],1)],1)],1)},s=[],i=t("c973"),r=t.n(i),o=t("ded3"),l=t.n(o),c=t("2f62"),p=t("b5ae"),d=t("bd4c");const m=p["helpers"].regex("alpha",/^[a-zA-Z0-9 ]*$/);var f={mounted:function(){this.getTableUsers(),this.setPagination()},data(){return{roles:["guest","user","admin","inactive"],selectedUser:{},showEditUser:!1,paginationOpts:{sortBy:"lastLoggedIn",descending:!1,page:1,rowsPerPage:5,rowsNumber:10},profileData:{firstname:"",lastname:"",company:"",city:"",role:""},columns:[{name:"name",required:!0,label:"Name",align:"left"},{name:"email",align:"center",label:"Email",field:"email",sortable:!0},{name:"company",align:"center",label:"Company",field:"company",sortable:!0},{name:"status",align:"center",label:"Status",field:"isVerified",format:e=>e?"Confirmed":"Pending",sortable:!1},{name:"role",align:"center",label:"Role",field:"permissions",sortable:!1},{name:"lastLoggedIn",align:"center",label:"Last Seen",field:"lastLoggedIn",sortable:!0,format:e=>""+(e?d["a"].formatDate(e,"DD MMM YY HH:mm A"):"Unknown")},{name:"action",align:"center",label:"Action"}]}},validations:{profileData:{firstname:{alpha:m,required:p["required"],minLength:Object(p["minLength"])(2),maxLength:Object(p["maxLength"])(30)},lastname:{alpha:m,required:p["required"],minLength:Object(p["minLength"])(2),maxLength:Object(p["maxLength"])(30)},company:{alpha:m,minLength:Object(p["minLength"])(2),maxLength:Object(p["maxLength"])(30)},city:{alpha:m,minLength:Object(p["minLength"])(2),maxLength:Object(p["maxLength"])(30)},role:{required:p["required"]}}},computed:l()(l()({},Object(c["c"])({users:e=>e.admin.users})),{},{disableUpdateProfile(){return this.$v.profileData.$invalid}}),methods:l()(l()({setPagination(){this.paginationOpts=this.$store.state.admin.userPaginationOpts},getTableUsers(e){var a=this;return r()((function*(){e?(a.paginationOpts=e.pagination,a.$store.commit("admin/setUserPagination",{userPaginationOpts:e.pagination}),yield a.getUsers({paginationOpts:e.pagination})):yield a.getUsers({paginationOpts:a.paginationOpts}),a.paginationOpts.rowsNumber=a.$store.state.admin.userPaginationOpts.rowsNumber}))()}},Object(c["b"])({getUsers:"admin/getUsers"})),{},{updateUser(e){this.profileData.firstname=e.firstname,this.profileData.lastname=e.lastname,this.profileData.city=e.city,this.profileData.company=e.company,this.profileData.role=e.permissions?e.permissions[0]:"",this.showEditUser=!0,this.selectedUser=e},resendEmailVerification(e){this.$store.dispatch("account/resendVerification",{email:e})},saveUpdatedUser(){var e=this;return r()((function*(){e.profileData.permissions=[e.profileData.role];let a=l()({},e.profileData);delete a.role,e.$store.dispatch("account/updateUser",{user:a,id:e.selectedUser._id,paginationOpts:e.paginationOpts})}))()},impersonate(e){},resetPassword(e){this.$store.dispatch("account/forgotPassword",{emailAddress:e})},deactiveateUser(e){var a=this;return r()((function*(){a.profileData.firstname=e.firstname,a.profileData.lastname=e.lastname,a.profileData.city=e.city,a.profileData.company=e.company,a.profileData.permissions=["inactive"];let t=l()({},a.profileData);delete t.role,a.$store.dispatch("account/updateUser",{user:t,id:e._id,paginationOpts:a.paginationOpts})}))()}})},u=f,v=t("2877"),g=t("9989"),b=t("eaac"),$=t("db86"),y=t("9c40"),h=t("24e8"),D=t("f09f"),q=t("a370"),x=t("27f9"),_=t("0016"),U=t("ddd8"),w=t("4b7e"),k=t("e669"),C=t("7f67"),L=t("eebe"),O=t.n(L),P=Object(v["a"])(u,n,s,!1,null,null,null);a["default"]=P.exports;O()(P,"components",{QPage:g["a"],QTable:b["a"],QTd:$["a"],QBtn:y["a"],QDialog:h["a"],QCard:D["a"],QCardSection:q["a"],QInput:x["a"],QIcon:_["a"],QSelect:U["a"],QCardActions:w["a"],QSpinnerFacebook:k["a"]}),O()(P,"directives",{ClosePopup:C["a"]})}}]);